# 스마트십 플랫폼 설치 규칙 (샘플)
# 실제 구현 시 스마트십 배포 방식에 맞게 단계·스크립트 경로를 수정합니다.

version: "1.0"

pre_checks:
  - name: disk_space
    min_gb: 10
  - name: memory
    min_mb: 2048
  - name: java_not_present_or_version
    expected_version: "17"

steps:
  - id: install_java
    script: scripts/install-java.sh
    args: ["{{ java_version }}"]
  - id: install_platform
    script: scripts/install-smartship.sh
    args: ["{{ platform_version }}", "{{ install_path }}"]
  - id: configure
    template: templates/app.yml.j2
    dest: "{{ install_path }}/config/application.yml"
  - id: register_service
    script: scripts/register-systemd.sh

on_failure:
  retry: 2
  rollback_script: scripts/rollback.sh
